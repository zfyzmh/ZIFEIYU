@using ZFY.ChatGpt.Dto;
@using ZIFEIYU.Global;

@foreach (var item in Messages)
{
    @if (item.Role!="user")
    {
        <div style="display:flex;   ">
            <div style=" margin-bottom: 10px; padding: 10px; max-width: 80%">
                <MudCard>
                    <MudCardContent>
                        @if (!IsCodeOver)
                        {
                            <MudMarkdown CodeBlockTheme="@CodeBlockTheme" Value="@item.Content" />
                        }
                        else
                        {
                            @((MarkupString)GetMarkdown(item.Content))
                        }
                       
                    </MudCardContent>
                </MudCard>
            </div>
           
        </div>
    }
    else
    {
        <div style="display:flex;" dir="rtl">
            <div dir="ltr" style=" margin-bottom: 10px; padding: 10px; max-width: 80%">
                <MudCard>
                    <MudCardContent>
                            @((MarkupString)GetMarkdown(item.Content))
                    </MudCardContent>
                </MudCard>
            </div>
          
        </div>
    }
}
<style>
    p {
        margin-top: 0;
        margin-bottom: 0;
    }
</style>
@code {
    [Parameter]
    public List<ChatMessage> Messages { get; set; }

    [Parameter]
    public bool IsCodeOver { get; set; }


    public CodeBlockTheme CodeBlockTheme { get {
            if ((bool)EventDispatcher.DispatchFunc("IsDarkTheme")) return CodeBlockTheme.Dark;
            else return CodeBlockTheme.Github;
        } }


    public string GetMarkdown(string? tes)
    {
        return Markdig.Markdown.ToHtml(tes ?? string.Empty);
    }
}

